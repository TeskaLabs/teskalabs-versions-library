# Release Notes v25.15

## Upgrade Procedure

**Upgrade path: v25.01 â†’ v25.15**

---

### Prerequisites

#### Elasticsearch

The upgrade includes a version bump of Elasticsearch from **7.17.21** to **7.17.28**.

* Log ingestion continues during the upgrade.
* Elasticsearch will temporarily enter the `red` or `yellow` state. Logs are not stored while the cluster is `red`, but they will be processed once the cluster returns to `green`.
* Monitor the cluster during the upgrade.

##### Pre-checks

* Ensure the cluster health is `green`.
* Avoid shard relocation or rebalancing.
* Check for oversharding and address it before proceeding.

##### Single-node or Test/Beta Environments

* Proceed with the LogMan.io uprade without additional steps.

##### Rolling Upgrade (Production)

1. Follow the official Elasticsearch rolling upgrade guide:
   [https://www.elastic.co/guide/en/elasticsearch/reference/7.17/rolling-upgrades.html](https://www.elastic.co/guide/en/elasticsearch/reference/7.17/rolling-upgrades.html)

2. Disable shard allocation:
```
PUT _cluster/settings
{
  "persistent": {
    "cluster.routing.allocation.enable": "primaries"
  }
}
```

3. Upgrade nodes tier by tier:

   * Start with **cold** nodes.
   * Continue with **warm**, **hot**, then **master** nodes.
   * Set the version in `model.yaml` for each instance, e.g.:

```yaml
services:
  elasticsearch:
   instances:
     cold-1:
       version: 7.17.28
       node: lmio-server-1
```

4. After upgrading each node:

   * Confirm node is up.
   * Wait for shard recovery and health status.
   * Proceed with the next node.

5. Once all nodes are upgraded, **re-enable shard allocation**:
```
PUT _cluster/settings
{
  "persistent": {
    "cluster.routing.allocation.enable": null
  }
}
```

**Note**: Elasticsearch does not support downgrades. If issues occur, complete the upgrade across all nodes and restore cluster health.

---

### Service Changes

#### `seacat-auth` Configuration

Legacy dual-instance configuration is deprecated. Update your model (/Site/model.yaml) by removing the outdated configuration. Example of the updated format:

```yaml
services:
  seacat-auth:
    - lmio-server-1
    - lmio-server-2
```

---

### Upgrade LogMan.io

1. Update versions in `Site/model.yaml`:

```yaml
applications:
 - name: "ASAB Maestro"
   version: v25.15
 - name: "LogMan.io"
   version: v25.15
```

2. On each node:

   * Navigate to `/opt/site`
   * Run: `./gov.sh up`

3. After all nodes are updated, repeat `./gov.sh up` on each node to ensure service consistency.

---

### Post-upgrade Steps

#### Elasticsearch Cleanup

* Remove any version overrides introduced in `model.yaml`.

#### New Microservices

Two new stateless services are introduced in v25.15:

* `lmio-feeds`
* `asab-discovery`

Add them to the `model.yaml` **after** the upgrade:

```yaml
services:
  lmio-feeds:
    - lmio-server-1

  asab-discovery:
    - lmio-server-1
```

**Notes**:

* One instance per service is sufficient.
* Run `asab-discovery` on all nodes for high availability.
* `lmio-feeds` can run on one or more nodes based on load.
* Service failures do not impact data collection.

#### Proxy settings is supported
Use HTTP_PROXY, HTTPS_PROXY and NO_PROXY in the model params. They will be automatically applied to all containers. All temporary mitigations can be replaced by this approach.

In model.yaml :
```yaml
params:
  HTTP_PROXY: http://X.X.X.X/
  HTTPS_PROXY: http://X.X.X.X/
  NO_PROXY: http://X.X.X.X/
```